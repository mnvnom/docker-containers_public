---
   - name: Update apt cache
     apt:
        update_cache: yes

   - name: Install required packages
     apt:
        name: "{{ item }}"
        state: present
     loop:
        - apt-transport-https
        - ca-certificates
        - curl
        - gnupg-agent
        - software-properties-common

   - name: Add Docker GPG key
     apt_key:
        url: https://download.docker.com/linux/ubuntu/gpg
        state: present

   - name: Add Docker repository
     apt_repository:
        repo: deb [arch=amd64] https://download.docker.com/linux/ubuntu bionic stable
        state: present
        
   - name: install pip for python 3
     apt:
       name: python3-pip
       state: present
     become: true
     when: ansible_python.version.major == 3

   - name: install python docker module
     pip:
       name: docker
       state: present

   - name: Update apt cache (again)
     apt:
        update_cache: yes

   - name: Install Docker
     apt:
      name: docker-ce
      state: present
   
   - name: Create Docker network
     docker_network:
       name: prometheus-network
     